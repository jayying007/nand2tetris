## 简介

nand2tetris 是一个教学项目，配套书籍《计算机系统要素-从零开始构建现代计算机》

官网：https://www.nand2tetris.org/

这里讲了电路设计，CPU设计，汇编，编译，操作系统开发等内容，可以对计算机体系有一个了解。

有个老外学完后，自己搭了个组装CPU的网站，可以去玩玩看：https://nandgame.com/

之前看过一本书《编码》，也是从底层讲起，可以当作互相补充。

## 学习指南

🔥记住，计算机体系中用的最多的就是抽象，每一章的知识都可以作为下一章的补充。在下一章中，你不用考虑之前章节已有的是如何实现的。

## 学习记录（2021/12/18复习一遍）

我基本保持一天一章的进度，所以这本书花了两周左右的时间看完了；

一些题还是挺有挑战难度的，有时一章两三个小时解决，有时一章要八九个小时才做完；一些第一遍看很懵，需要再看一遍。

最后操作系统部分没有做完，这部分其实就是用自己写的编程语言实现一些标准库，操作系统那些进程调度、文件系统、内存管理还是看其他书。

### 第一章 布尔逻辑

> 逻辑设计的艺术：给定门的描述（外部接口），通过应用已经实现的门，找到有效的方法实现它。

建议去官网，看看那些tools工具要怎么使用(书中在适当的地方也会提醒你)，它们都是用Java写的，所以前提是你安装了Java。

这章主要是学习如何编写HDL硬件描述语言，然后拿几个简单的逻辑门组合电路练练手。知道怎么用它提供的工具来测试你的代码。

开局只给了你一个NAND门，不过没告诉你它的实现细节。本章要求利用这个NAND门去实现基本逻辑门。先利用NAND门去实现与、或、非三种逻辑门，再用这三种逻辑门去实现其他逻辑门。

### 第二章 布尔运算

这一章还是组合电路，比较有难度的是ALU。而之前我用MineCraft实现过3bit的加法器，所以前几个问题不大。

https://www.bilibili.com/video/BV1R3411z7ew?share_source=copy_web

ALU的作用还是很强大的，当你设计好之后，下次你想计算两个数x和y的运算，比如计算x-y或者x&y或者-1，你只需传入适当的数到zx,nx,zy,ny...这些地方就可以了。

灵活使用Mux选择器是实现ALU的关键

### 第三章 时序逻辑

这一章默认给了个DFF，这个DFF实现还是挺难也挺巧妙的，我记得在《编码》这本书有它的电路图，这组件被称为触发器或者锁存器。

这一章主要是熟悉DFF这个组件，计数器的实现也得动下脑筋。看看如何巧妙地利用Mux选择器实现if、else if、else的条件跳转。

### 第四章 机器语言

这一章介绍了Hack的机器语言，或者说汇编语言。它只有A指令和C指令。

注意在运行和屏幕有关的程序时，把那个Animate的选项设置为No animation，不然单步运行会很慢。

注意屏幕像素点的换算，在一块256x512像素的屏幕上，有8K的地址空间来映射，则平均1bit代表2像素点。你应该让每一个bit都为1，而不是每个byte为1。

### 第五章 计算机体系结构

这个承接上一章，上一章教了你Hack的汇编语法，现在教你如何构建一台计算机，它能够识别这种语法并执行。这里完成了核心CPU的设计，不得不说，很精妙，做完会很有成就感。

建议参考图5.9来辅助CPU的设计，帮助会很大。

> 高级语言可以利用if实现分支，而在底层，你要学会如何利用选择器和反向选择器来实现这个功能。

**第六章**

上一章是制造了计算机，能够识别那些01010；这一章是写汇编编译器，把你的学的汇编语法给翻译成0101.

**第七、八章**

这两章讲了一个VM中间代码层，并要求你编写翻译程序，能将VM代码给翻译成你学的汇编语法。

中间代码的好处是，之后你的Jack语言只要把代码翻译为中间代码，比如mac上面有将中间代码转为机器语言的程序，那就可以运行。

**第九章**

这一章对于学过高级语言C、Java、Python等同学来说很容易理解。

没有作业，就是让你熟悉一下它的语法规则而已。

**第十、十一章**

学了Jack语法后，你会发现它所有语句第一个词都能很好地区分这是一条什么语句，这对编程人员可能稍微不大友好，但为编译器开发者来说真是福音，它让我们地工作轻松了很多。

这两章就是要你写个编译器，实现将Jack语言转为VM中间代码。

> 我曾经也想写编译器，看了《自制脚本语言》，《自制编程语言》，看了编译课程，学了两三天都很难入门。这本书只用了两章的内容，就可以让我独立编写出编译器，真的很过瘾。
>
> 当然，关于编译有很多考虑的东西，因为Jack语言简单都忽略了，不过并不影响你能写一个能跑起来的程序

在第十章生成xml那里，我觉得要先理解好语法分析树，然后递归很好写的。

写编译器的时候一定要看图10.5，前面的理解了，靠这张图就能写。

**第十二章**

这一章是写操作系统，我没有全部写。这块内容比较熟悉了，就不花时间继续深究了，或许以后有空可以来补补吧。

